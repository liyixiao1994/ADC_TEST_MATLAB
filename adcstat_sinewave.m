% using Matlab to analyze ADC's static performance when the input is sine wave
% Author: Zhu Kai
% Emensa Tech.
% Version 20080310

clear;
close all;
% for mmmm=1:2
numbit = 9;
numdel = 0;
sign_code= 0 ;    % 0 represent Ô­Âë, 1 represent ²¹Âë
numLSB=2^numbit;
num_missingcode=0;

% ---------------------------------------------------
%  read data from data file to matrix named "rawdata"
% ---------------------------------------------------

fileName = input('Type data file name: ','s');
if isempty(fileName)
    return;
end
fid = fopen(fileName,'r');
if (fid == -1) 
    fprintf('File not found.');
    return;
end

k=1;
for skip=1:k
	line = fgetl(fid);
end

for i=1:numLSB
   x=fscanf(fid,'%d %d %e',3);
   data(i)=x(2);
   line = fgetl(fid);
end
fclose(fid);

numbit=numbit-numdel;
numLSB=2^numbit;
for i=1:numLSB
    count(i)=sum(data(((2^numdel)*i-(2^numdel)+1):((2^numdel)*i)));
end
% if sign_code==0
%     for i=1:numLSB
%         count(i)=data(i);
%     end
% else if sign_code==1
%     for i=1:(numLSB/2)
%         count(i)=data(i+numLSB/2);
%         count(i+numLSB/2)=data(i);
%     end
% end
% end
% ---------------------------------------------------
%  To determine the point_start and point_end
% ---------------------------------------------------
a=count(1:(numLSB/2));                        % a starts from 1
b=count((numLSB/2+1):numLSB);                       % b starts from 513
[count_max1,point_start]=max(a);           % acquire point_start
[count_max2,point_end]=max(b);  
point_end=point_end+numLSB/2;                      % acquire point_end
% point_start=287;
% point_end=16023;
point_start=point_start +0;
point_end  =point_end   -0;
fprintf('* Accepted points start from %d to %d\n',point_start,point_end);

%%%%%%%%%%%%%%%%%%%%%%%%
Amp_count=numLSB/2;
dPnts=sum(count(1:numLSB));
fprintf('* Total accepted sampling points : %d\n',dPnts);
fprintf('\n****************Static Performance Testing Results*****************\n\n');

Amp_count(1)=Amp_count;
for i=1:2000
    temp=i;
    Amp_end(i)  =Amp_count(i)*(1-cos((pi*sum(count(point_end:numLSB)))/dPnts));
    Amp_start(i)=Amp_count(i)*(1-cos((pi*sum(count(1:point_start)))/dPnts));
    Amp_count(i+1)=(point_end+1-point_start)/2+(Amp_end(i)+Amp_start(i)-2)/2;
    if abs(Amp_count(i+1)-Amp_count(i))<(1/(2^numbit)/(10^10))
        Amp_end =Amp_end(i) ;
        Amp_start=Amp_start(i);
        Amp_count=Amp_count(i+1);
        break;
    end
end
% temp

% for i=1:2000
%     Amp_end  =Amp_count*(1-cos((pi*sum(count(point_end:numLSB)))/dPnts));
%     Amp_start=Amp_count*(1-cos((pi*sum(count(1:point_start)))/dPnts));
%     Amp_count=(point_end+1-point_start)/2+(Amp_end+Amp_start-2)/2;
% end
% Amp_count=(numLSB/2-1)/(sin((pi/2)*(sum(count((point_start+1):(point_end-1)))/dPnts)))
% if there is offset existing, the upper formula is wrong!!
% Amp_end  =Amp_count*(1-cos((pi*sum(count(point_end:numLSB)))/dPnts))
% Amp_start=Amp_count*(1-cos((pi*sum(count(1:point_start)))/dPnts))

OFFSET_count=(point_start+1-Amp_start+point_end+Amp_end)/2;
Offset_Error_LSB=OFFSET_count-numLSB/2-1;
Offset_Error_percent=Offset_Error_LSB/(numLSB);
fprintf('    Offset_Error = %.2fLSB / %.2f%%FSR \n',Offset_Error_LSB,Offset_Error_percent*100);

%%%%%%%%%%%%%%%%%%%%%%%%%%
percent=zeros(1,numLSB);
PT=zeros(1,numLSB);
DNL=zeros(1,numLSB);
INL=zeros(1,numLSB);

% for i=(point_start+1):(point_end-1)
%     percent(i)=(count(i)/dPnts)*100; 
%     PT(i)=(asin((i+1-OFFSET_count)/Amp_count)-asin((i-OFFSET_count)/Amp_count))*(100/pi);
% end
% 
% k=(point_start+1):(point_end-1);
% figure('color','w');
% axes('FontSize',12.5);
% box on;
% plot(k-1,percent(k),'b-',k-1,PT(k),'r-');
% title('PERCENT OF OUTPUT',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% xlabel('DIGITAL OUTPUT',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% ylabel('PERCENT OF OUTPUT[%]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% grid

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for i=(point_start+1):point_end
    H(i)=sum(count(1:(i-1)));
    point_esti(i)=OFFSET_count-Amp_count*(cos((pi*H(i))/dPnts));
end

for i=(point_start+1):(point_end-1)
    DNL(i)=point_esti(i+1)-point_esti(i)-1;  %DNL starts from point_start+1  to  point_end-1
    if DNL(i)<-0.9
        if sign_code==0
%         fprintf('    the output %d is a missing code\n',i-1);
    else if sign_code==1
%         fprintf('    the output %d is a missing code\n',i-1-numLSB/2);
       end
       end
        num_missingcode = num_missingcode+1;
    end
end

if num_missingcode==0
    fprintf('    There is no missing codes!\n');
else
    fprintf('    There is %d missing code(s)!\n',num_missingcode);
end


for i=(point_start+1):point_end
    INL(i)=point_esti(i)-i;                  %INL starts from point_start+1  to  point_end
end

[DNL_max,DNL_max_point]=max(DNL);
[DNL_min,DNL_min_point]=min(DNL);
fprintf('    Minimum DNL : DNL(%6d) = %5.2f LSB\n',DNL_min_point-1,DNL_min);
fprintf('    Maximum DNL : DNL(%6d) = %5.2f LSB\n',DNL_max_point-1,DNL_max);


[INL_max,INL_max_point]=max(INL);
[INL_min,INL_min_point]=min(INL);
fprintf('    Minimum INL : INL(%6d) = %5.2f LSB\n',INL_min_point-1,INL_min);
fprintf('    Maximum INL : INL(%6d) = %5.2f LSB\n',INL_max_point-1,INL_max);
fprintf('\n*******************************************************************\n\n');

% k=(point_start+1):point_end;
% figure('color','w');
% axes('FontSize',12.5);
% box on;
% plot(k-1,k-2,'r-');
% hold on;
% plot([0,point_start],[point_start-1,point_start-1],'b-');
% plot([point_esti(point_end)-1,point_esti(point_end)-1],[point_end-2,point_end-1],'b-');
% plot([point_esti(point_end)-1,numLSB],[point_end-1,point_end-1],'b-');
% for i=(point_start+1):(point_end-1)
%     plot([point_esti(i)-1,point_esti(i)-1],[i-2,i-1],'b-',[point_esti(i)-1,point_esti(i+1)-1],[i-1,i-1],'b-');
% end
% title('point_esti',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% xlabel('Input / point_esti[LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% ylabel('DIGITAL OUTPUT',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% grid;
% 
k_DNL = (point_start+1):(point_end-1);
figure('color','w');
axes('FontSize',12.5);
box on;
plot(k_DNL-1,DNL(k_DNL),'k-');
% title('DNL',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
xlabel('OUTPUT CODE',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
ylabel('DNL ERROR [LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
grid;

k_INL = (point_start+1):point_end;
figure('color','w');
axes('FontSize',12.5);
box on;
plot(k_INL-1,INL(k_INL),'k-');
% title('INL',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
xlabel('OUTPUT CODE',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
ylabel('INL ERROR [LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
grid;
% hold on
% end
% 
% vref=2*max(INL_max,-INL_min);
% %%%%  INL+1st stage
% figure('color','w');
% axes('FontSize',12.5);
% box on;
% plot(k_INL-1,INL(k_INL),'b-');
% hold on;
% plot([ 3*(2^(numbit-3)), 3*(2^(numbit-3))],[0.5*vref,-0.5*vref],'r-',...
%      [ 5*(2^(numbit-3)), 5*(2^(numbit-3))],[0.5*vref,-0.5*vref],'r-');
% title('INL+1st stage',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% xlabel('OUTPUT CODE',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% ylabel('INL ERROR [LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% grid;
% %%%%  INL+2nd stage
% figure('color','w');
% axes('FontSize',12.5);
% box on;
% plot(k_INL-1,INL(k_INL),'b-');
% hold on;
% plot([ 3*(2^(numbit-4)), 3*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',...
%      [ 5*(2^(numbit-4)), 5*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',...
%      [ 7*(2^(numbit-4)), 7*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',...
%      [ 9*(2^(numbit-4)), 9*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',...
%      [11*(2^(numbit-4)),11*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',...
%      [13*(2^(numbit-4)),13*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-');
% title('INL+2nd stage',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% xlabel('OUTPUT CODE',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% ylabel('INL ERROR [LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% grid;
% %%%%  INL+3rd stage
% figure('color','w');
% axes('FontSize',12.5);
% box on;
% plot(k_INL-1,INL(k_INL),'b-');
% hold on;
% plot([ 3*(2^(numbit-5)), 3*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',...
%      [ 5*(2^(numbit-5)), 5*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',...
%      [ 7*(2^(numbit-5)), 7*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',...
%      [ 9*(2^(numbit-5)), 9*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',...
%      [11*(2^(numbit-5)),11*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',...
%      [13*(2^(numbit-5)),13*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',...
%      [15*(2^(numbit-5)),15*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-');
% plot([17*(2^(numbit-5)),17*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',...
%      [19*(2^(numbit-5)),19*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',...
%      [21*(2^(numbit-5)),21*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',...
%      [23*(2^(numbit-5)),23*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',...
%      [25*(2^(numbit-5)),25*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',...
%      [27*(2^(numbit-5)),27*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',...
%      [29*(2^(numbit-5)),29*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-');
% title('INL+3rd stage',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% xlabel('OUTPUT CODE',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% ylabel('INL ERROR [LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% grid;
% %%%%  INL+4th stage
% figure('color','w');
% axes('FontSize',12.5);
% box on;
% plot(k_INL-1,INL(k_INL),'b-');
% hold on;
% plot([ 3*(2^(numbit-6)), 3*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [ 5*(2^(numbit-6)), 5*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [ 7*(2^(numbit-6)), 7*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [ 9*(2^(numbit-6)), 9*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [11*(2^(numbit-6)),11*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [13*(2^(numbit-6)),13*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [15*(2^(numbit-6)),15*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-');
% plot([17*(2^(numbit-6)),17*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [19*(2^(numbit-6)),19*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [21*(2^(numbit-6)),21*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [23*(2^(numbit-6)),23*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [25*(2^(numbit-6)),25*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [27*(2^(numbit-6)),27*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [29*(2^(numbit-6)),29*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [31*(2^(numbit-6)),31*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-');
% plot([33*(2^(numbit-6)),33*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [35*(2^(numbit-6)),35*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [37*(2^(numbit-6)),37*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [39*(2^(numbit-6)),39*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [41*(2^(numbit-6)),41*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [43*(2^(numbit-6)),43*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [45*(2^(numbit-6)),45*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [47*(2^(numbit-6)),47*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-');
% plot([49*(2^(numbit-6)),49*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [51*(2^(numbit-6)),51*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [53*(2^(numbit-6)),53*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [55*(2^(numbit-6)),55*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [57*(2^(numbit-6)),57*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [59*(2^(numbit-6)),59*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
%      [61*(2^(numbit-6)),61*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-');
% title('INL+4th stage',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% xlabel('OUTPUT CODE',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% ylabel('INL ERROR [LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% grid;
% %%%%  INL+5th stage
% figure('color','w');
% axes('FontSize',12.5);
% box on;
% plot(k_INL-1,INL(k_INL),'b-');
% hold on;
% plot([  3*(2^(numbit-7)),  3*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [  5*(2^(numbit-7)),  5*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [  7*(2^(numbit-7)),  7*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [  9*(2^(numbit-7)),  9*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 11*(2^(numbit-7)), 11*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 13*(2^(numbit-7)), 13*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 15*(2^(numbit-7)), 15*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-');
% plot([ 17*(2^(numbit-7)), 17*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 19*(2^(numbit-7)), 19*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 21*(2^(numbit-7)), 21*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 23*(2^(numbit-7)), 23*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 25*(2^(numbit-7)), 25*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 27*(2^(numbit-7)), 27*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 29*(2^(numbit-7)), 29*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 31*(2^(numbit-7)), 31*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-');
% plot([ 33*(2^(numbit-7)), 33*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 35*(2^(numbit-7)), 35*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 37*(2^(numbit-7)), 37*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 39*(2^(numbit-7)), 39*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 41*(2^(numbit-7)), 41*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 43*(2^(numbit-7)), 43*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 45*(2^(numbit-7)), 45*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 47*(2^(numbit-7)), 47*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-');
% plot([ 49*(2^(numbit-7)), 49*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 51*(2^(numbit-7)), 51*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 53*(2^(numbit-7)), 53*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 55*(2^(numbit-7)), 55*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 57*(2^(numbit-7)), 57*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 59*(2^(numbit-7)), 59*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 61*(2^(numbit-7)), 61*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-');
% plot([ 63*(2^(numbit-7)), 63*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 65*(2^(numbit-7)), 65*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 67*(2^(numbit-7)), 67*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 69*(2^(numbit-7)), 69*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 71*(2^(numbit-7)), 71*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 73*(2^(numbit-7)), 73*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 75*(2^(numbit-7)), 75*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 77*(2^(numbit-7)), 77*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-');
% plot([ 79*(2^(numbit-7)), 79*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 81*(2^(numbit-7)), 81*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 83*(2^(numbit-7)), 83*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 85*(2^(numbit-7)), 85*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 87*(2^(numbit-7)), 87*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 89*(2^(numbit-7)), 89*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 91*(2^(numbit-7)), 91*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-');
% plot([ 93*(2^(numbit-7)), 93*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 95*(2^(numbit-7)), 95*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 97*(2^(numbit-7)), 97*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [ 99*(2^(numbit-7)), 99*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [101*(2^(numbit-7)),101*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [103*(2^(numbit-7)),103*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [105*(2^(numbit-7)),105*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [107*(2^(numbit-7)),107*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-');
% plot([109*(2^(numbit-7)),109*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [111*(2^(numbit-7)),111*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [113*(2^(numbit-7)),113*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [115*(2^(numbit-7)),115*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [117*(2^(numbit-7)),117*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [119*(2^(numbit-7)),119*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [121*(2^(numbit-7)),121*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [123*(2^(numbit-7)),123*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-',...
%      [125*(2^(numbit-7)),125*(2^(numbit-7))],[0.5*vref,-0.5*vref],'r-');
% title('INL+5th stage',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% xlabel('OUTPUT CODE',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% ylabel('INL ERROR [LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% grid;
% %%%%  INL+6th stage
% figure('color','w');
% axes('FontSize',12.5);
% box on;
% plot(k_INL-1,INL(k_INL),'b-');
% hold on;
% plot([  3*(2^(numbit-8)),  3*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [  5*(2^(numbit-8)),  5*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [  7*(2^(numbit-8)),  7*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [  9*(2^(numbit-8)),  9*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 11*(2^(numbit-8)), 11*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 13*(2^(numbit-8)), 13*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 15*(2^(numbit-8)), 15*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');
% plot([ 17*(2^(numbit-8)), 17*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 19*(2^(numbit-8)), 19*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 21*(2^(numbit-8)), 21*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 23*(2^(numbit-8)), 23*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 25*(2^(numbit-8)), 25*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 27*(2^(numbit-8)), 27*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 29*(2^(numbit-8)), 29*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 31*(2^(numbit-8)), 31*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');
% plot([ 33*(2^(numbit-8)), 33*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 35*(2^(numbit-8)), 35*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 37*(2^(numbit-8)), 37*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 39*(2^(numbit-8)), 39*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 41*(2^(numbit-8)), 41*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 43*(2^(numbit-8)), 43*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 45*(2^(numbit-8)), 45*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 47*(2^(numbit-8)), 47*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');
% plot([ 49*(2^(numbit-8)), 49*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 51*(2^(numbit-8)), 51*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 53*(2^(numbit-8)), 53*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 55*(2^(numbit-8)), 55*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 57*(2^(numbit-8)), 57*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 59*(2^(numbit-8)), 59*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 61*(2^(numbit-8)), 61*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');
% plot([ 63*(2^(numbit-8)), 63*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 65*(2^(numbit-8)), 65*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 67*(2^(numbit-8)), 67*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 69*(2^(numbit-8)), 69*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 71*(2^(numbit-8)), 71*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 73*(2^(numbit-8)), 73*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 75*(2^(numbit-8)), 75*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 77*(2^(numbit-8)), 77*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');
% plot([ 79*(2^(numbit-8)), 79*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 81*(2^(numbit-8)), 81*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 83*(2^(numbit-8)), 83*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 85*(2^(numbit-8)), 85*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 87*(2^(numbit-8)), 87*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 89*(2^(numbit-8)), 89*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 91*(2^(numbit-8)), 91*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');
% plot([ 93*(2^(numbit-8)), 93*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 95*(2^(numbit-8)), 95*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 97*(2^(numbit-8)), 97*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [ 99*(2^(numbit-8)), 99*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [101*(2^(numbit-8)),101*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [103*(2^(numbit-8)),103*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [105*(2^(numbit-8)),105*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [107*(2^(numbit-8)),107*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');
% plot([109*(2^(numbit-8)),109*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [111*(2^(numbit-8)),111*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [113*(2^(numbit-8)),113*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [115*(2^(numbit-8)),115*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [117*(2^(numbit-8)),117*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [119*(2^(numbit-8)),119*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [121*(2^(numbit-8)),121*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [123*(2^(numbit-8)),123*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [125*(2^(numbit-8)),125*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');
% plot([127*(2^(numbit-8)),127*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [129*(2^(numbit-8)),129*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [131*(2^(numbit-8)),131*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [133*(2^(numbit-8)),133*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [135*(2^(numbit-8)),135*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [137*(2^(numbit-8)),137*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [139*(2^(numbit-8)),139*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [141*(2^(numbit-8)),141*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [143*(2^(numbit-8)),143*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');
% plot([145*(2^(numbit-8)),145*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [147*(2^(numbit-8)),147*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [149*(2^(numbit-8)),149*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [151*(2^(numbit-8)),151*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [153*(2^(numbit-8)),153*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [155*(2^(numbit-8)),155*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [157*(2^(numbit-8)),157*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [159*(2^(numbit-8)),159*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [161*(2^(numbit-8)),161*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');
% plot([163*(2^(numbit-8)),163*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [165*(2^(numbit-8)),165*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [167*(2^(numbit-8)),167*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [169*(2^(numbit-8)),169*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [171*(2^(numbit-8)),171*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [173*(2^(numbit-8)),173*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [175*(2^(numbit-8)),175*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [177*(2^(numbit-8)),177*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [179*(2^(numbit-8)),179*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');    
% plot([181*(2^(numbit-8)),181*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [183*(2^(numbit-8)),183*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [185*(2^(numbit-8)),185*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [187*(2^(numbit-8)),187*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [189*(2^(numbit-8)),189*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [191*(2^(numbit-8)),191*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [193*(2^(numbit-8)),193*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [195*(2^(numbit-8)),195*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [197*(2^(numbit-8)),197*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');
% plot([199*(2^(numbit-8)),199*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [201*(2^(numbit-8)),201*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [203*(2^(numbit-8)),203*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [205*(2^(numbit-8)),205*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [207*(2^(numbit-8)),207*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [209*(2^(numbit-8)),209*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [211*(2^(numbit-8)),211*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [213*(2^(numbit-8)),213*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [215*(2^(numbit-8)),215*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');
% plot([217*(2^(numbit-8)),217*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [219*(2^(numbit-8)),219*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [221*(2^(numbit-8)),221*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [223*(2^(numbit-8)),223*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [225*(2^(numbit-8)),225*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [227*(2^(numbit-8)),227*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [229*(2^(numbit-8)),229*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [231*(2^(numbit-8)),231*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [233*(2^(numbit-8)),233*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');   
% plot([235*(2^(numbit-8)),235*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [237*(2^(numbit-8)),237*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [239*(2^(numbit-8)),239*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [241*(2^(numbit-8)),241*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [243*(2^(numbit-8)),243*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [245*(2^(numbit-8)),245*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [247*(2^(numbit-8)),247*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [249*(2^(numbit-8)),249*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [251*(2^(numbit-8)),251*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-',...
%      [253*(2^(numbit-8)),253*(2^(numbit-8))],[0.5*vref,-0.5*vref],'r-');                       
% title('INL+6th stage',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% xlabel('OUTPUT CODE',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% ylabel('INL ERROR [LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% grid;
% 
% 
% %%%%  INL+1st+2nd+3rd+4th stage
% figure('color','w');
% axes('FontSize',12.5);
% box on;
% plot(k_INL-1,INL(k_INL),'b-');
% hold on;
% plot([ 3*(2^(numbit-3)), 3*(2^(numbit-3))],[0.5*vref,-0.5*vref],'r-',...
%      [ 5*(2^(numbit-3)), 5*(2^(numbit-3))],[0.5*vref,-0.5*vref],'r-');
%  
% plot([ 3*(2^(numbit-4)), 3*(2^(numbit-4))],[0.5*vref,-0.5*vref],'g-',...
%      [ 5*(2^(numbit-4)), 5*(2^(numbit-4))],[0.5*vref,-0.5*vref],'g-',...
%      [ 7*(2^(numbit-4)), 7*(2^(numbit-4))],[0.5*vref,-0.5*vref],'g-',...
%      [ 9*(2^(numbit-4)), 9*(2^(numbit-4))],[0.5*vref,-0.5*vref],'g-',...
%      [11*(2^(numbit-4)),11*(2^(numbit-4))],[0.5*vref,-0.5*vref],'g-',...
%      [13*(2^(numbit-4)),13*(2^(numbit-4))],[0.5*vref,-0.5*vref],'g-');
%  
% plot([ 3*(2^(numbit-5)), 3*(2^(numbit-5))],[0.5*vref,-0.5*vref],'m-',...
%      [ 5*(2^(numbit-5)), 5*(2^(numbit-5))],[0.5*vref,-0.5*vref],'m-',...
%      [ 7*(2^(numbit-5)), 7*(2^(numbit-5))],[0.5*vref,-0.5*vref],'m-',...
%      [ 9*(2^(numbit-5)), 9*(2^(numbit-5))],[0.5*vref,-0.5*vref],'m-',...
%      [11*(2^(numbit-5)),11*(2^(numbit-5))],[0.5*vref,-0.5*vref],'m-',...
%      [13*(2^(numbit-5)),13*(2^(numbit-5))],[0.5*vref,-0.5*vref],'m-',...
%      [15*(2^(numbit-5)),15*(2^(numbit-5))],[0.5*vref,-0.5*vref],'m-');
% plot([17*(2^(numbit-5)),17*(2^(numbit-5))],[0.5*vref,-0.5*vref],'m-',...
%      [19*(2^(numbit-5)),19*(2^(numbit-5))],[0.5*vref,-0.5*vref],'m-',...
%      [21*(2^(numbit-5)),21*(2^(numbit-5))],[0.5*vref,-0.5*vref],'m-',...
%      [23*(2^(numbit-5)),23*(2^(numbit-5))],[0.5*vref,-0.5*vref],'m-',...
%      [25*(2^(numbit-5)),25*(2^(numbit-5))],[0.5*vref,-0.5*vref],'m-',...
%      [27*(2^(numbit-5)),27*(2^(numbit-5))],[0.5*vref,-0.5*vref],'m-',...
%      [29*(2^(numbit-5)),29*(2^(numbit-5))],[0.5*vref,-0.5*vref],'m-');
%  
% plot([ 3*(2^(numbit-6)), 3*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [ 5*(2^(numbit-6)), 5*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [ 7*(2^(numbit-6)), 7*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [ 9*(2^(numbit-6)), 9*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [11*(2^(numbit-6)),11*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [13*(2^(numbit-6)),13*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [15*(2^(numbit-6)),15*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-');
% plot([17*(2^(numbit-6)),17*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [19*(2^(numbit-6)),19*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [21*(2^(numbit-6)),21*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [23*(2^(numbit-6)),23*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [25*(2^(numbit-6)),25*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [27*(2^(numbit-6)),27*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [29*(2^(numbit-6)),29*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [31*(2^(numbit-6)),31*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-');
% plot([33*(2^(numbit-6)),33*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [35*(2^(numbit-6)),35*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [37*(2^(numbit-6)),37*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [39*(2^(numbit-6)),39*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [41*(2^(numbit-6)),41*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [43*(2^(numbit-6)),43*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [45*(2^(numbit-6)),45*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [47*(2^(numbit-6)),47*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-');
% plot([49*(2^(numbit-6)),49*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [51*(2^(numbit-6)),51*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [53*(2^(numbit-6)),53*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [55*(2^(numbit-6)),55*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [57*(2^(numbit-6)),57*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [59*(2^(numbit-6)),59*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-',...
%      [61*(2^(numbit-6)),61*(2^(numbit-6))],[0.5*vref,-0.5*vref],'k-');
% title('INL+1st+2nd+3rd+4th stage',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% xlabel('OUTPUT CODE',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% ylabel('INL ERROR [LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% grid;
% 
% 
% % vref=2*max(INL_max,-INL_min);
% % %%%%  INL+1st stage
% % figure('color','w');
% % axes('FontSize',12.5);
% % box on;
% % plot(k_INL-1,INL(k_INL),'b-');
% % hold on;
% % plot([1*(2^(numbit-3)),3*(2^(numbit-3))],[-0.5*vref,0.5*vref],'r-',...
% %      [3*(2^(numbit-3)),3*(2^(numbit-3))],[0.5*vref,-0.5*vref],'r-',[3*(2^(numbit-3)),5*(2^(numbit-3))],[-0.5*vref,0.5*vref],'r-',...
% %      [5*(2^(numbit-3)),5*(2^(numbit-3))],[0.5*vref,-0.5*vref],'r-',...
% %      [5*(2^(numbit-3)),7*(2^(numbit-3))],[-0.5*vref,0.5*vref],'r-');
% % title('INL+1st stage',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % xlabel('OUTPUT CODE',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % ylabel('INL ERROR [LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % grid;
% % %%%%  INL+2nd stage
% % figure('color','w');
% % plot(k_INL-1,INL(k_INL),'b-');
% % hold on;
% % plot([ 1*(2^(numbit-4)), 3*(2^(numbit-4))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 3*(2^(numbit-4)), 3*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',[ 3*(2^(numbit-4)), 5*(2^(numbit-4))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 5*(2^(numbit-4)), 5*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',[ 5*(2^(numbit-4)), 7*(2^(numbit-4))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 7*(2^(numbit-4)), 7*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',[ 7*(2^(numbit-4)), 9*(2^(numbit-4))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 9*(2^(numbit-4)), 9*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',[ 9*(2^(numbit-4)),11*(2^(numbit-4))],[-0.5*vref,0.5*vref],'r-',...
% %      [11*(2^(numbit-4)),11*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',[11*(2^(numbit-4)),13*(2^(numbit-4))],[-0.5*vref,0.5*vref],'r-',...
% %      [13*(2^(numbit-4)),13*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',...
% %      [13*(2^(numbit-4)),15*(2^(numbit-4))],[-0.5*vref,0.5*vref],'r-');
% % title('INL+2nd stage',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % xlabel('OUTPUT CODE',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % ylabel('INL ERROR [LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % grid;
% % %%%%  INL+3rd stage
% % figure('color','w');
% % plot(k_INL-1,INL(k_INL),'b-');
% % hold on;
% % plot([ 1*(2^(numbit-5)), 3*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 3*(2^(numbit-5)), 3*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[ 3*(2^(numbit-5)), 5*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 5*(2^(numbit-5)), 5*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[ 5*(2^(numbit-5)), 7*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 7*(2^(numbit-5)), 7*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[ 7*(2^(numbit-5)), 9*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 9*(2^(numbit-5)), 9*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[ 9*(2^(numbit-5)),11*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [11*(2^(numbit-5)),11*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[11*(2^(numbit-5)),13*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [13*(2^(numbit-5)),13*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[13*(2^(numbit-5)),15*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [15*(2^(numbit-5)),15*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[15*(2^(numbit-5)),17*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-');
% % plot([17*(2^(numbit-5)),17*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[17*(2^(numbit-5)),19*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [19*(2^(numbit-5)),19*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[19*(2^(numbit-5)),21*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [21*(2^(numbit-5)),21*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[21*(2^(numbit-5)),23*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [23*(2^(numbit-5)),23*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[23*(2^(numbit-5)),25*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [25*(2^(numbit-5)),25*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[25*(2^(numbit-5)),27*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [27*(2^(numbit-5)),27*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[27*(2^(numbit-5)),29*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [29*(2^(numbit-5)),29*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',...
% %      [29*(2^(numbit-5)),31*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-');
% % title('INL+3rd stage',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % xlabel('OUTPUT CODE',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % ylabel('INL ERROR [LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % grid;
% % %%%%  INL+4th stage
% % figure('color','w');
% % axes('FontSize',12.5);
% % box on;
% % plot(k_INL-1,INL(k_INL),'b-');
% % hold on;
% % plot([ 1*(2^(numbit-6)), 3*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 3*(2^(numbit-6)), 3*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[ 3*(2^(numbit-6)), 5*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 5*(2^(numbit-6)), 5*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[ 5*(2^(numbit-6)), 7*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 7*(2^(numbit-6)), 7*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[ 7*(2^(numbit-6)), 9*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 9*(2^(numbit-6)), 9*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[ 9*(2^(numbit-6)),11*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [11*(2^(numbit-6)),11*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[11*(2^(numbit-6)),13*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [13*(2^(numbit-6)),13*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[13*(2^(numbit-6)),15*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [15*(2^(numbit-6)),15*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[15*(2^(numbit-6)),17*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-');
% % plot([17*(2^(numbit-6)),17*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[17*(2^(numbit-6)),19*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [19*(2^(numbit-6)),19*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[19*(2^(numbit-6)),21*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [21*(2^(numbit-6)),21*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[21*(2^(numbit-6)),23*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [23*(2^(numbit-6)),23*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[23*(2^(numbit-6)),25*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [25*(2^(numbit-6)),25*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[25*(2^(numbit-6)),27*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [27*(2^(numbit-6)),27*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[27*(2^(numbit-6)),29*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [29*(2^(numbit-6)),29*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[29*(2^(numbit-6)),31*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [31*(2^(numbit-6)),31*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[31*(2^(numbit-6)),33*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-');
% % plot([33*(2^(numbit-6)),33*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[33*(2^(numbit-6)),35*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [35*(2^(numbit-6)),35*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[35*(2^(numbit-6)),37*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [37*(2^(numbit-6)),37*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[37*(2^(numbit-6)),39*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [39*(2^(numbit-6)),39*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[39*(2^(numbit-6)),41*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [41*(2^(numbit-6)),41*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[41*(2^(numbit-6)),43*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [43*(2^(numbit-6)),43*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[43*(2^(numbit-6)),45*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [45*(2^(numbit-6)),45*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[45*(2^(numbit-6)),47*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [47*(2^(numbit-6)),47*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[47*(2^(numbit-6)),49*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-');
% % plot([49*(2^(numbit-6)),49*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[49*(2^(numbit-6)),51*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [51*(2^(numbit-6)),51*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[51*(2^(numbit-6)),53*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [53*(2^(numbit-6)),53*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[53*(2^(numbit-6)),55*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [55*(2^(numbit-6)),55*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[55*(2^(numbit-6)),57*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [57*(2^(numbit-6)),57*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[57*(2^(numbit-6)),59*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [59*(2^(numbit-6)),59*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[59*(2^(numbit-6)),61*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [61*(2^(numbit-6)),61*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
% %      [61*(2^(numbit-6)),63*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-');
% % title('INL+4th stage',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % xlabel('OUTPUT CODE',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % ylabel('INL ERROR [LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % grid;
% % 
% % %%%%  INL+1st+2nd+3rd+4th stage
% % figure('color','w');
% % axes('FontSize',12.5);
% % box on;
% % plot(k_INL-1,INL(k_INL),'b-');
% % hold on;
% % plot([1*(2^(numbit-3)),3*(2^(numbit-3))],[-0.5*vref,0.5*vref],'r-',...
% %      [3*(2^(numbit-3)),3*(2^(numbit-3))],[0.5*vref,-0.5*vref],'r-',[3*(2^(numbit-3)),5*(2^(numbit-3))],[-0.5*vref,0.5*vref],'r-',...
% %      [5*(2^(numbit-3)),5*(2^(numbit-3))],[0.5*vref,-0.5*vref],'r-',...
% %      [5*(2^(numbit-3)),7*(2^(numbit-3))],[-0.5*vref,0.5*vref],'r-');
% %  
% % plot([ 1*(2^(numbit-4)), 3*(2^(numbit-4))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 3*(2^(numbit-4)), 3*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',[ 3*(2^(numbit-4)), 5*(2^(numbit-4))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 5*(2^(numbit-4)), 5*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',[ 5*(2^(numbit-4)), 7*(2^(numbit-4))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 7*(2^(numbit-4)), 7*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',[ 7*(2^(numbit-4)), 9*(2^(numbit-4))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 9*(2^(numbit-4)), 9*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',[ 9*(2^(numbit-4)),11*(2^(numbit-4))],[-0.5*vref,0.5*vref],'r-',...
% %      [11*(2^(numbit-4)),11*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',[11*(2^(numbit-4)),13*(2^(numbit-4))],[-0.5*vref,0.5*vref],'r-',...
% %      [13*(2^(numbit-4)),13*(2^(numbit-4))],[0.5*vref,-0.5*vref],'r-',...
% %      [13*(2^(numbit-4)),15*(2^(numbit-4))],[-0.5*vref,0.5*vref],'r-');
% %  
% % plot([ 1*(2^(numbit-5)), 3*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 3*(2^(numbit-5)), 3*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[ 3*(2^(numbit-5)), 5*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 5*(2^(numbit-5)), 5*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[ 5*(2^(numbit-5)), 7*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 7*(2^(numbit-5)), 7*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[ 7*(2^(numbit-5)), 9*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 9*(2^(numbit-5)), 9*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[ 9*(2^(numbit-5)),11*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [11*(2^(numbit-5)),11*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[11*(2^(numbit-5)),13*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [13*(2^(numbit-5)),13*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[13*(2^(numbit-5)),15*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [15*(2^(numbit-5)),15*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[15*(2^(numbit-5)),17*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-');
% % plot([17*(2^(numbit-5)),17*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[17*(2^(numbit-5)),19*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [19*(2^(numbit-5)),19*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[19*(2^(numbit-5)),21*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [21*(2^(numbit-5)),21*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[21*(2^(numbit-5)),23*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [23*(2^(numbit-5)),23*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[23*(2^(numbit-5)),25*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [25*(2^(numbit-5)),25*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[25*(2^(numbit-5)),27*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [27*(2^(numbit-5)),27*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',[27*(2^(numbit-5)),29*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-',...
% %      [29*(2^(numbit-5)),29*(2^(numbit-5))],[0.5*vref,-0.5*vref],'r-',...
% %      [29*(2^(numbit-5)),31*(2^(numbit-5))],[-0.5*vref,0.5*vref],'r-');
% %  
% % plot([ 1*(2^(numbit-6)), 3*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 3*(2^(numbit-6)), 3*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[ 3*(2^(numbit-6)), 5*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 5*(2^(numbit-6)), 5*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[ 5*(2^(numbit-6)), 7*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 7*(2^(numbit-6)), 7*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[ 7*(2^(numbit-6)), 9*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [ 9*(2^(numbit-6)), 9*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[ 9*(2^(numbit-6)),11*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [11*(2^(numbit-6)),11*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[11*(2^(numbit-6)),13*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [13*(2^(numbit-6)),13*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[13*(2^(numbit-6)),15*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [15*(2^(numbit-6)),15*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[15*(2^(numbit-6)),17*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-');
% % plot([17*(2^(numbit-6)),17*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[17*(2^(numbit-6)),19*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [19*(2^(numbit-6)),19*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[19*(2^(numbit-6)),21*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [21*(2^(numbit-6)),21*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[21*(2^(numbit-6)),23*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [23*(2^(numbit-6)),23*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[23*(2^(numbit-6)),25*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [25*(2^(numbit-6)),25*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[25*(2^(numbit-6)),27*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [27*(2^(numbit-6)),27*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[27*(2^(numbit-6)),29*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [29*(2^(numbit-6)),29*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[29*(2^(numbit-6)),31*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [31*(2^(numbit-6)),31*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[31*(2^(numbit-6)),33*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-');
% % plot([33*(2^(numbit-6)),33*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[33*(2^(numbit-6)),35*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [35*(2^(numbit-6)),35*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[35*(2^(numbit-6)),37*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [37*(2^(numbit-6)),37*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[37*(2^(numbit-6)),39*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [39*(2^(numbit-6)),39*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[39*(2^(numbit-6)),41*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [41*(2^(numbit-6)),41*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[41*(2^(numbit-6)),43*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [43*(2^(numbit-6)),43*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[43*(2^(numbit-6)),45*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [45*(2^(numbit-6)),45*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[45*(2^(numbit-6)),47*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [47*(2^(numbit-6)),47*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[47*(2^(numbit-6)),49*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-');
% % plot([49*(2^(numbit-6)),49*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[49*(2^(numbit-6)),51*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [51*(2^(numbit-6)),51*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[51*(2^(numbit-6)),53*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [53*(2^(numbit-6)),53*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[53*(2^(numbit-6)),55*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [55*(2^(numbit-6)),55*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[55*(2^(numbit-6)),57*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [57*(2^(numbit-6)),57*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[57*(2^(numbit-6)),59*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [59*(2^(numbit-6)),59*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',[59*(2^(numbit-6)),61*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-',...
% %      [61*(2^(numbit-6)),61*(2^(numbit-6))],[0.5*vref,-0.5*vref],'r-',...
% %      [61*(2^(numbit-6)),63*(2^(numbit-6))],[-0.5*vref,0.5*vref],'r-');
% % title('INL+1st+2nd+3rd+4th stage',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % xlabel('OUTPUT CODE',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % ylabel('INL ERROR [LSB]',          'color','k','FontSize',12.5,'FontName','Arial','FontWeight','normal');
% % grid;
